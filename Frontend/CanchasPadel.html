<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva Canchas Pádel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #ff7e5f;
            --dark-color: #333;
            --light-color: #f8f9fa;
            --success-color: #28a745;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: var(--dark-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            display: flex;
            align-items: center;
        }

        .logo i {
            margin-right: 10px;
            color: var(--secondary-color);
        }

        /* Auth Buttons */
        .auth-buttons button {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            margin-left: 10px;
            transition: all 0.3s;
        }

        .login-btn {
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .register-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .auth-buttons button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: var(--primary-color);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--dark-color);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .form-submit {
            width: 100%;
            padding: 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.3s;
        }

        .form-submit:hover {
            background-color: #3a5a8f;
        }

        .form-footer {
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
        }

        .form-footer a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        /* Main Content */
        .main-title {
            text-align: center;
            margin: 30px 0;
            color: var(--primary-color);
        }

        /* Courts Grid */
        .courts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .court-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .court-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .court-image {
            height: 180px;
            background-size: cover;
            background-position: center;
        }

        .court-info {
            padding: 15px;
        }

        .court-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .court-location, .court-price {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }

        .court-location i, .court-price i {
            margin-right: 5px;
            color: var(--secondary-color);
        }

        .court-description {
            font-size: 14px;
            margin: 10px 0;
            color: #555;
        }

        .book-btn {
            width: 100%;
            padding: 8px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .book-btn:hover {
            background-color: #e66a4a;
        }

        /* Booking Modal */
        .booking-modal {
            max-width: 800px;
        }

        .booking-header {
            display: flex;
            margin-bottom: 20px;
        }

        .booking-image {
            width: 200px;
            height: 150px;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            margin-right: 20px;
        }

        .booking-info h3 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .booking-info p {
            color: #666;
            margin-bottom: 5px;
        }

        .calendar-container {
            margin: 20px 0;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .calendar-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .calendar-nav button {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: var(--dark-color);
            padding: 5px 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            padding: 5px;
            color: var(--primary-color);
        }

        .calendar-day {
            height: 60px;
            border: 1px solid #eee;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .calendar-day:hover {
            background-color: #f0f0f0;
        }

        .day-number {
            font-size: 12px;
            font-weight: 600;
        }

        .time-slots {
            font-size: 10px;
            color: var(--success-color);
        }

        .day-disabled {
            color: #ccc;
            background-color: #f9f9f9;
            cursor: not-allowed;
        }

        .day-selected {
            background-color: var(--primary-color);
            color: white;
        }

        .time-slots-container {
            margin-top: 20px;
        }

        .time-slots-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .time-slots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
        }

        .time-slot {
            padding: 8px;
            text-align: center;
            background-color: #f0f0f0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .time-slot:hover {
            background-color: #ddd;
        }

        .time-slot.selected {
            background-color: var(--secondary-color);
            color: white;
        }

        .time-slot.booked {
            background-color: #ffcccc;
            color: #990000;
            cursor: not-allowed;
            text-decoration: line-through;
        }

        .add-to-cart-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .add-to-cart-btn:hover {
            background-color: #218838;
        }

        /* Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100%;
            background-color: white;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            transition: right 0.3s;
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .cart-header h3 {
            color: var(--primary-color);
        }

        .close-cart-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--dark-color);
        }

        .cart-items {
            margin-bottom: 20px;
        }

        .cart-item {
            display: flex;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .cart-item-image {
            width: 80px;
            height: 60px;
            background-size: cover;
            background-position: center;
            border-radius: 5px;
            margin-right: 15px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .cart-item-details {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .cart-item-remove {
            color: #ff4d4d;
            font-size: 12px;
            cursor: pointer;
            display: inline-block;
            margin-top: 5px;
        }

        .cart-summary {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .checkout-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .checkout-btn:hover {
            background-color: #e66a4a;
        }

        .cart-icon {
            position: relative;
            margin-left: 20px;
            cursor: pointer;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .courts-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }

            .booking-header {
                flex-direction: column;
            }

            .booking-image {
                width: 100%;
                height: 200px;
                margin-right: 0;
                margin-bottom: 15px;
            }

            .cart-sidebar {
                width: 90%;
                right: -90%;
            }
        }

        /* User Section */
        .user-section {
            display: flex;
            align-items: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .user-name {
            font-weight: 500;
            margin-right: 15px;
        }

        .logout-btn {
            background: none;
            border: none;
            color: var(--dark-color);
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .logout-btn i {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-tennis-ball"></i>
                <span>Pádel Reservas</span>
            </div>
            
            <div class="user-section" id="userSection" style="display: none;">
                <div class="user-avatar" id="userAvatar">U</div>
                <span class="user-name" id="userName">Usuario</span>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    Salir
                </button>
                <div class="cart-icon" id="cartIcon">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count" id="cartCount">0</span>
                </div>
            </div>
            
            <div class="auth-buttons" id="authButtons">
                <button class="login-btn" id="loginBtn">Iniciar Sesión</button>
                <button class="register-btn" id="registerBtn">Registrarse</button>
            </div>
        </div>
    </header>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Iniciar Sesión</h2>
                <button class="close-btn" id="closeLoginModal">&times;</button>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Correo Electrónico</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Contraseña</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="form-submit">Ingresar</button>
            </form>
            <div class="form-footer">
                ¿No tienes una cuenta? <a href="#" id="showRegisterFromLogin">Regístrate aquí</a>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Crear Cuenta</h2>
                <button class="close-btn" id="closeRegisterModal">&times;</button>
            </div>
            <form id="registerForm">
                <div class="form-group">
                    <label for="registerName">Nombre Completo</label>
                    <input type="text" id="registerName" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">Correo Electrónico</label>
                    <input type="email" id="registerEmail" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Contraseña</label>
                    <input type="password" id="registerPassword" required>
                </div>
                <div class="form-group">
                    <label for="registerConfirmPassword">Confirmar Contraseña</label>
                    <input type="password" id="registerConfirmPassword" required>
                </div>
                <button type="submit" class="form-submit">Registrarse</button>
            </form>
            <div class="form-footer">
                ¿Ya tienes una cuenta? <a href="#" id="showLoginFromRegister">Inicia sesión aquí</a>
            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div class="modal" id="bookingModal">
        <div class="modal-content booking-modal">
            <div class="modal-header">
                <h2>Reservar Cancha</h2>
                <button class="close-btn" id="closeBookingModal">&times;</button>
            </div>
            
            <div class="booking-header">
                <div class="booking-image" id="bookingCourtImage" style="background-image: url('https://images.unsplash.com/photo-1543357480-c60d400e2ef9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80');"></div>
                <div class="booking-info">
                    <h3 id="bookingCourtName">Cancha Premium</h3>
                    <p><i class="fas fa-map-marker-alt"></i> <span id="bookingCourtLocation">Club Deportivo, Santiago</span></p>
                    <p><i class="fas fa-tag"></i> <span id="bookingCourtPrice">$15,000 por hora</span></p>
                    <p id="bookingCourtDescription">Cancha de pádel premium con superficie de césped artificial y iluminación LED.</p>
                </div>
            </div>
            
            <div class="calendar-container">
                <div class="calendar-header">
                    <div class="calendar-title" id="calendarMonth">Junio 2023</div>
                    <div class="calendar-nav">
                        <button id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                        <button id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                
                <div class="calendar-grid" id="calendarDaysHeader">
                    <div class="calendar-day-header">Lun</div>
                    <div class="calendar-day-header">Mar</div>
                    <div class="calendar-day-header">Mié</div>
                    <div class="calendar-day-header">Jue</div>
                    <div class="calendar-day-header">Vie</div>
                    <div class="calendar-day-header">Sáb</div>
                    <div class="calendar-day-header">Dom</div>
                </div>
                
                <div class="calendar-grid" id="calendarDays">
                    <!-- Los días del calendario se generarán con JavaScript -->
                </div>
            </div>
            
            <div class="time-slots-container" id="timeSlotsContainer" style="display: none;">
                <div class="time-slots-title">Horarios Disponibles</div>
                <div class="time-slots-grid" id="timeSlotsGrid">
                    <!-- Los horarios disponibles se generarán con JavaScript -->
                </div>
            </div>
            
            <button class="add-to-cart-btn" id="addToCartBtn" style="display: none;">Agregar al Carrito</button>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Tu Carrito de Reservas</h3>
            <button class="close-cart-btn" id="closeCartBtn">&times;</button>
        </div>
        
        <div class="cart-items" id="cartItems">
            <!-- Los items del carrito se generarán con JavaScript -->
            <div class="empty-cart-message" id="emptyCartMessage">No hay reservas en tu carrito.</div>
        </div>
        
        <div class="cart-summary">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cartTotal">$0</span>
            </div>
            <button class="checkout-btn" id="checkoutBtn">Proceder al Pago</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <h1 class="main-title">Reserva tu Cancha de Pádel</h1>
        
        <div class="courts-grid" id="courtsGrid">
            <!-- Cancha 1 -->
            <div class="court-card" data-court-id="1">
                <div class="court-image" style="background-image: url('https://www.greenpro.com.ar/paddle/GP%20GYM/2.jpg');"></div>
                <div class="court-info">
                    <div class="court-name">Cancha Premium</div>
                    <div class="court-location"><i class="fas fa-map-marker-alt"></i> Club Deportivo, Santiago</div>
                    <div class="court-price"><i class="fas fa-tag"></i> $15,000 por hora</div>
                    <div class="court-description">Cancha de pádel premium con superficie de césped artificial e iluminación LED.</div>
                    <button class="book-btn">Reservar</button>
                </div>
            </div>
            
            <!-- Cancha 2 -->
            <div class="court-card" data-court-id="2">
                <div class="court-image" style="background-image: url('https://img.freepik.com/foto-gratis/hombre-jugando-padel_657883-621.jpg?semt=ais_hybrid&w=740');"></div>
                <div class="court-info">
                    <div class="court-name">Cancha Estándar</div>
                    <div class="court-location"><i class="fas fa-map-marker-alt"></i> Parque Deportivo, Providencia</div>
                    <div class="court-price"><i class="fas fa-tag"></i> $12,000 por hora</div>
                    <div class="court-description">Cancha estándar con superficie de hormigón poroso y buena iluminación.</div>
                    <button class="book-btn">Reservar</button>
                </div>
            </div>
            
            <!-- Cancha 3 -->
            <div class="court-card" data-court-id="3">
                <div class="court-image" style="background-image: url('https://www.greenpro.com.ar/fotos%20GP/historia-del-padel-portada.jpg');"></div>
                <div class="court-info">
                    <div class="court-name">Cancha VIP</div>
                    <div class="court-location"><i class="fas fa-map-marker-alt"></i> Country Club, Las Condes</div>
                    <div class="court-price"><i class="fas fa-tag"></i> $20,000 por hora</div>
                    <div class="court-description">Cancha VIP con superficie de vidrio y sistema de sonido integrado.</div>
                    <button class="book-btn">Reservar</button>
                </div>
            </div>
            
            <!-- Cancha 4 -->
            <div class="court-card" data-court-id="4">
                <div class="court-image" style="background-image: url('https://img.freepik.com/foto-gratis/pelota-padel-golpeando-red_23-2149459039.jpg?semt=ais_hybrid&w=740');"></div>
                <div class="court-info">
                    <div class="court-name">Cancha Básica</div>
                    <div class="court-location"><i class="fas fa-map-marker-alt"></i> Centro Deportivo, Ñuñoa</div>
                    <div class="court-price"><i class="fas fa-tag"></i> $10,000 por hora</div>
                    <div class="court-description">Cancha básica ideal para principiantes y práctica casual.</div>
                    <button class="book-btn">Reservar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentUser = null;
        // Removed duplicate declaration of cartItems
        let currentCourt = null;
        let selectedDate = null;
        let selectedTime = null;
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        // DOM Elements
        const loginBtn = document.getElementById('loginBtn');
        const registerBtn = document.getElementById('registerBtn');
        const loginModal = document.getElementById('loginModal');
        const registerModal = document.getElementById('registerModal');
        const bookingModal = document.getElementById('bookingModal');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const closeRegisterModal = document.getElementById('closeRegisterModal');
        const closeBookingModal = document.getElementById('closeBookingModal');
        const showRegisterFromLogin = document.getElementById('showRegisterFromLogin');
        const showLoginFromRegister = document.getElementById('showLoginFromRegister');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const authButtons = document.getElementById('authButtons');
        const userSection = document.getElementById('userSection');
        const userName = document.getElementById('userName');
        const userAvatar = document.getElementById('userAvatar');
        const logoutBtn = document.getElementById('logoutBtn');
        const bookButtons = document.querySelectorAll('.book-btn');
        const courtsGrid = document.getElementById('courtsGrid');
        const bookingCourtName = document.getElementById('bookingCourtName');
        const bookingCourtLocation = document.getElementById('bookingCourtLocation');
        const bookingCourtPrice = document.getElementById('bookingCourtPrice');
        const bookingCourtDescription = document.getElementById('bookingCourtDescription');
        const bookingCourtImage = document.getElementById('bookingCourtImage');
        const calendarMonth = document.getElementById('calendarMonth');
        const calendarDays = document.getElementById('calendarDays');
        const prevMonthBtn = document.getElementById('prevMonth');
        const nextMonthBtn = document.getElementById('nextMonth');
        const timeSlotsContainer = document.getElementById('timeSlotsContainer');
        const timeSlotsGrid = document.getElementById('timeSlotsGrid');
        const addToCartBtn = document.getElementById('addToCartBtn');
        const cartIcon = document.getElementById('cartIcon');
        const cartSidebar = document.getElementById('cartSidebar');
        const closeCartBtn = document.getElementById('closeCartBtn');
        const cartItems = document.getElementById('cartItems');
        const emptyCartMessage = document.getElementById('emptyCartMessage');
        const cartTotal = document.getElementById('cartTotal');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const cartCount = document.getElementById('cartCount');

        // Event Listeners
        loginBtn.addEventListener('click', () => loginModal.style.display = 'flex');
        registerBtn.addEventListener('click', () => registerModal.style.display = 'flex');
        closeLoginModal.addEventListener('click', () => loginModal.style.display = 'none');
        closeRegisterModal.addEventListener('click', () => registerModal.style.display = 'none');
        closeBookingModal.addEventListener('click', closeBookingModalHandler);
        showRegisterFromLogin.addEventListener('click', showRegisterFromLoginHandler);
        showLoginFromRegister.addEventListener('click', showLoginFromRegisterHandler);
        loginForm.addEventListener('submit', loginHandler);
        registerForm.addEventListener('submit', registerHandler);
        logoutBtn.addEventListener('click', logoutHandler);
        prevMonthBtn.addEventListener('click', () => changeMonth(-1));
        nextMonthBtn.addEventListener('click', () => changeMonth(1));
        cartIcon.addEventListener('click', toggleCartSidebar);
        closeCartBtn.addEventListener('click', toggleCartSidebar);
        checkoutBtn.addEventListener('click', checkoutHandler);
        addToCartBtn.addEventListener('click', addToCartHandler);

        // Delegated event listeners
        courtsGrid.addEventListener('click', (e) => {
            if (e.target.classList.contains('book-btn')) {
                const courtCard = e.target.closest('.court-card');
                openBookingModal(courtCard);
            }
        });

        calendarDays.addEventListener('click', (e) => {
            if (e.target.classList.contains('calendar-day') && !e.target.classList.contains('day-disabled')) {
                selectDate(e.target);
            }
        });

        timeSlotsGrid.addEventListener('click', (e) => {
            if (e.target.classList.contains('time-slot') && !e.target.classList.contains('booked')) {
                selectTimeSlot(e.target);
            }
        });

        cartItems.addEventListener('click', (e) => {
            if (e.target.classList.contains('cart-item-remove')) {
                const itemId = e.target.getAttribute('data-item-id');
                removeFromCart(itemId);
            }
        });

        // Functions
        function showRegisterFromLoginHandler(e) {
            e.preventDefault();
            loginModal.style.display = 'none';
            registerModal.style.display = 'flex';
        }

        function showLoginFromRegisterHandler(e) {
            e.preventDefault();
            registerModal.style.display = 'none';
            loginModal.style.display = 'flex';
        }

        function loginHandler(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simulación de login exitoso
            // En una implementación real, esto sería una llamada al backend
            currentUser = {
                name: email.split('@')[0],
                email: email
            };
            
            updateUIAfterLogin();
            loginModal.style.display = 'none';
            
            // Limpiar el formulario
            loginForm.reset();
            
            // Mostrar notificación
            alert(`Bienvenido, ${currentUser.name}!`);
        }

        function registerHandler(e) {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            if (password !== confirmPassword) {
                alert('Las contraseñas no coinciden');
                return;
            }
            
            // Simulación de registro exitoso
            // En una implementación real, esto sería una llamada al backend
            currentUser = {
                name: name,
                email: email
            };
            
            updateUIAfterLogin();
            registerModal.style.display = 'none';
            
            // Limpiar el formulario
            registerForm.reset();
            
            // Mostrar notificación
            alert(`Registro exitoso! Bienvenido, ${currentUser.name}!`);
        }

        function logoutHandler() {
            currentUser = null;
            authButtons.style.display = 'flex';
            userSection.style.display = 'none';
            
            // Mostrar notificación
            alert('Has cerrado sesión correctamente.');
        }

        function updateUIAfterLogin() {
            authButtons.style.display = 'none';
            userSection.style.display = 'flex';
            userName.textContent = currentUser.name;
            userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
        }

        function openBookingModal(courtCard) {
            if (!currentUser) {
                alert('Por favor inicia sesión para reservar una cancha.');
                loginModal.style.display = 'flex';
                return;
            }
            
            // Obtener datos de la cancha
            currentCourt = {
                id: courtCard.getAttribute('data-court-id'),
                name: courtCard.querySelector('.court-name').textContent,
                location: courtCard.querySelector('.court-location').textContent.replace(' Club Deportivo, ', ''),
                price: courtCard.querySelector('.court-price').textContent.replace('$', '').replace(' por hora', ''),
                description: courtCard.querySelector('.court-description').textContent,
                image: courtCard.querySelector('.court-image').style.backgroundImage
            };
            
            // Actualizar el modal con los datos de la cancha
            bookingCourtName.textContent = currentCourt.name;
            bookingCourtLocation.textContent = currentCourt.location;
            bookingCourtPrice.textContent = `$${currentCourt.price} por hora`;
            bookingCourtDescription.textContent = currentCourt.description;
            bookingCourtImage.style.backgroundImage = currentCourt.image;
            
            // Resetear selecciones
            selectedDate = null;
            selectedTime = null;
            timeSlotsContainer.style.display = 'none';
            addToCartBtn.style.display = 'none';
            
            // Generar calendario
            generateCalendar();
            
            // Mostrar el modal
            bookingModal.style.display = 'flex';
        }

        function closeBookingModalHandler() {
            bookingModal.style.display = 'none';
        }

        function generateCalendar() {
            // Configurar mes y año actual
            const date = new Date(currentYear, currentMonth, 1);
            calendarMonth.textContent = `${getMonthName(currentMonth)} ${currentYear}`;
            
            // Limpiar días anteriores
            calendarDays.innerHTML = '';
            
            // Obtener el primer día del mes (0-6, donde 0 es domingo)
            const firstDay = date.getDay();
            // Ajustar para que la semana comience en lunes
            const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
            
            // Obtener el último día del mes
            const lastDay = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Obtener el último día del mes anterior
            const prevLastDay = new Date(currentYear, currentMonth, 0).getDate();
            
            // Días del mes anterior
            for (let i = adjustedFirstDay; i > 0; i--) {
                const day = prevLastDay - i + 1;
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day', 'day-disabled');
                dayElement.innerHTML = `<div class="day-number">${day}</div>`;
                calendarDays.appendChild(dayElement);
            }
            
            // Días del mes actual
            const today = new Date();
            for (let i = 1; i <= lastDay; i++) {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day');
                dayElement.setAttribute('data-day', i);
                dayElement.setAttribute('data-month', currentMonth);
                dayElement.setAttribute('data-year', currentYear);
                
                // Marcar si es hoy
                if (i === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) {
                    dayElement.classList.add('day-selected');
                }
                
                // Simular disponibilidad (en una implementación real, esto vendría del backend)
                const randomSlots = Math.floor(Math.random() * 5) + 1;
                dayElement.innerHTML = `
                    <div class="day-number">${i}</div>
                    <div class="time-slots">${randomSlots} horario${randomSlots !== 1 ? 's' : ''} disponible${randomSlots !== 1 ? 's' : ''}</div>
                `;
                
                calendarDays.appendChild(dayElement);
            }
            
            // Días del próximo mes
            const daysLeft = 42 - (adjustedFirstDay + lastDay); // 6 semanas de 7 días
            for (let i = 1; i <= daysLeft; i++) {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day', 'day-disabled');
                dayElement.innerHTML = `<div class="day-number">${i}</div>`;
                calendarDays.appendChild(dayElement);
            }
        }

        function getMonthName(monthIndex) {
            const months = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            return months[monthIndex];
        }

        function changeMonth(change) {
            currentMonth += change;
            
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            
            generateCalendar();
        }

        function selectDate(dayElement) {
            // Quitar selección anterior
            const previouslySelected = document.querySelector('.calendar-day.day-selected');
            if (previouslySelected) {
                previouslySelected.classList.remove('day-selected');
            }
            
            // Marcar como seleccionado
            dayElement.classList.add('day-selected');
            
            // Guardar fecha seleccionada
            selectedDate = {
                day: dayElement.getAttribute('data-day'),
                month: dayElement.getAttribute('data-month'),
                year: dayElement.getAttribute('data-year')
            };
            
            // Mostrar horarios disponibles
            showTimeSlots();
        }

        function showTimeSlots() {
            // Simular horarios disponibles (en una implementación real, esto vendría del backend)
            const availableSlots = [];
            const startHour = 8; // 8 AM
            const endHour = 22; // 10 PM
            
            // Generar horarios aleatorios disponibles
            for (let hour = startHour; hour < endHour; hour++) {
                // 50% de probabilidad de que el horario esté disponible
                if (Math.random() > 0.5) {
                    availableSlots.push({
                        time: `${hour}:00 - ${hour + 1}:00`,
                        price: currentCourt.price
                    });
                }
            }
            
            // Mostrar contenedor de horarios
            timeSlotsContainer.style.display = 'block';
            
            // Limpiar horarios anteriores
            timeSlotsGrid.innerHTML = '';
            
            // Agregar horarios disponibles
            availableSlots.forEach((slot, index) => {
                const slotElement = document.createElement('div');
                slotElement.classList.add('time-slot');
                slotElement.setAttribute('data-slot-index', index);
                slotElement.textContent = slot.time;
                timeSlotsGrid.appendChild(slotElement);
            });
        }

        function selectTimeSlot(slotElement) {
            // Quitar selección anterior
            const previouslySelected = document.querySelector('.time-slot.selected');
            if (previouslySelected) {
                previouslySelected.classList.remove('selected');
            }
            
            // Marcar como seleccionado
            slotElement.classList.add('selected');
            
            // Guardar horario seleccionado
            selectedTime = slotElement.textContent;
            
            // Mostrar botón de agregar al carrito
            addToCartBtn.style.display = 'block';
        }

        function addToCartHandler() {
            if (!selectedDate || !selectedTime) {
                alert('Por favor selecciona una fecha y horario.');
                return;
            }
            
            // Crear item para el carrito
            const cartItem = {
                id: `${currentCourt.id}-${selectedDate.day}-${selectedDate.month}-${selectedDate.year}-${selectedTime}`,
                courtId: currentCourt.id,
                name: currentCourt.name,
                date: `${selectedDate.day}/${parseInt(selectedDate.month) + 1}/${selectedDate.year}`,
                time: selectedTime,
                price: parseInt(currentCourt.price),
                image: currentCourt.image
            };
            
            // Agregar al carrito
            cartItems.push(cartItem);
            
            // Actualizar UI del carrito
            updateCartUI();
            
            // Mostrar notificación
            alert('Reserva agregada al carrito!');
            
            // Cerrar el modal de reserva
            bookingModal.style.display = 'none';
        }

        function toggleCartSidebar() {
            cartSidebar.classList.toggle('open');
        }

        function updateCartUI() {
            // Actualizar contador del carrito
            cartCount.textContent = cartItems.length;
            
            // Mostrar/ocultar mensaje de carrito vacío
            if (cartItems.length === 0) {
                emptyCartMessage.style.display = 'block';
                document.querySelectorAll('.cart-item').forEach(el => el.remove());
            } else {
                emptyCartMessage.style.display = 'none';
                
                // Limpiar items anteriores
                document.querySelectorAll('.cart-item').forEach(el => el.remove());
                
                // Agregar items actuales
                cartItems.forEach(item => {
                    const cartItemElement = document.createElement('div');
                    cartItemElement.classList.add('cart-item');
                    cartItemElement.innerHTML = `
                        <div class="cart-item-image" style="background-image: ${item.image}"></div>
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-details">${item.date} - ${item.time}</div>
                            <div class="cart-item-details">$${item.price}</div>
                            <div class="cart-item-remove" data-item-id="${item.id}">Eliminar</div>
                        </div>
                    `;
                    cartItems.insertBefore(cartItemElement, emptyCartMessage);
                });
                
                // Calcular total
                const total = cartItems.reduce((sum, item) => sum + item.price, 0);
                cartTotal.textContent = `$${total}`;
            }
        }

        function removeFromCart(itemId) {
            // Filtrar el item a eliminar
            cartItems = cartItems.filter(item => item.id !== itemId);
            
            // Actualizar UI del carrito
            updateCartUI();
            
            // Mostrar notificación
            alert('Reserva eliminada del carrito.');
        }

        function checkoutHandler() {
            if (cartItems.length === 0) {
                alert('No hay reservas en el carrito.');
                return;
            }
            
            // Simular proceso de pago
            alert(`Procesando pago por $${cartTotal.textContent.replace('$', '')}...`);
            
            // Limpiar carrito
            cartItems = [];
            updateCartUI();
            
            // Cerrar sidebar
            toggleCartSidebar();
            
            // Mostrar confirmación
            alert('¡Pago exitoso! Tus reservas han sido confirmadas. Recibirás un correo con los detalles.');
        }

        // Inicializar calendario al cargar la página
        document.addEventListener('DOMContentLoaded', generateCalendar);
    </script>
</body>
</html>